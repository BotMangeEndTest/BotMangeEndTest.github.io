(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[798],{46809:function($,J,a){"use strict";a.r(J),a.d(J,{default:function(){return Te}});var K=a(15009),h=a.n(K),y=a(99289),k=a.n(y),D=a(5574),i=a.n(D),B=a(92861),x=a(29933),Y=a(94272),A=a(78957),E=a(83622),L=a(4393),R=a(55054),oe=a(74330),P=a(78045),de=a(26915),Q=a(96068),ce=a(85265),ve=a(9220),n=a(67294),fe=a(64599),pe=a.n(fe),me=a(80652),he=a(27484),U=a.n(he),e=a(85893),ge=function(j){var c=j.type,s=j.value,w=(0,n.useState)(!1),l=i()(w,2),I=l[0],v=l[1],Z=(0,Y.useIntl)(),F=(0,n.useState)([]),C=i()(F,2),T=C[0],S=C[1],H=function(){var o=k()(h()().mark(function u(){var f,g,t,b,M,N;return h()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,v(!0),p.next=4,B.Z.promotionTrack.getListByDay(30,c,s);case 4:if(f=p.sent,f){g=[],t=pe()(f);try{for(t.s();!(b=t.n()).done;)M=b.value,N=U()(M.date).format("YYYY-MM-DD"),g.push({date:N,type:Z.formatMessage({id:"pages.promotionTrack.view"}),count:M.view}),g.push({date:N,type:Z.formatMessage({id:"pages.promotionTrack.download"}),count:M.download}),g.push({date:N,type:Z.formatMessage({id:"pages.promotionTrack.register"}),count:M.register})}catch(z){t.e(z)}finally{t.f()}g=g.reverse(),S(g)}v(!1),p.next=14;break;case 9:return p.prev=9,p.t0=p.catch(0),v(!1),console.error(p.t0),p.abrupt("return",!1);case 14:case"end":return p.stop()}},u,null,[[0,9]])}));return function(){return o.apply(this,arguments)}}();return(0,n.useEffect)(function(){H()},[c,s]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(me.Z,{data:T,xField:"date",yField:"count",colorField:"type",axis:{y:{labelFormatter:function(u){return u.toLocaleString()}}},shapeField:"smooth",scale:{y:{domainMin:0}},tooltip:{channel:"y",valueFormatter:function(u){return u.toLocaleString()}}})})},xe=ge,je=function(j){var c=j.type,s=j.value,w=(0,n.useState)(!1),l=i()(w,2),I=l[0],v=l[1],Z=(0,n.useState)([]),F=i()(Z,2),C=F[0],T=F[1],S=[{title:"date",dataIndex:"date",render:function(u,f,g){return U()(u).format("YYYY-MM-DD")}},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"view"},{title:"\u4E0B\u8F7D\u6B21\u6570",dataIndex:"download"},{title:"\u6CE8\u518C\u6B21\u6570",dataIndex:"register"},{title:"\u72EC\u7ACBIP\u6570",dataIndex:"ip"},{title:"\u72EC\u7ACB\u8BBE\u5907\u6570",dataIndex:"deviceId"}],H=function(){var o=k()(h()().mark(function u(){var f;return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,v(!0),t.next=4,B.Z.promotionTrack.getListByLimit(90,c,s);case 4:f=t.sent,f&&T(f),v(!1),t.next=14;break;case 9:return t.prev=9,t.t0=t.catch(0),v(!1),console.error(t.t0),t.abrupt("return",!1);case 14:case"end":return t.stop()}},u,null,[[0,9]])}));return function(){return o.apply(this,arguments)}}();return(0,n.useEffect)(function(){H()},[c,s]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Q.Z,{size:"small",columns:S,dataSource:C,pagination:!1})})},ye=je,Se=function(j){var c=j.type,s=j.value,w=(0,n.useState)(!1),l=i()(w,2),I=l[0],v=l[1],Z=(0,n.useState)([]),F=i()(Z,2),C=F[0],T=F[1],S=[{title:"\u65F6\u95F4",dataIndex:"eventTime",render:function(u,f,g){return U().unix(u).format("YYYY-MM-DD")},minWidth:120},{title:"Category",dataIndex:"category"},{title:"utm_source",dataIndex:"utmSource"},{title:"eid",dataIndex:"eid"},{title:"pid",dataIndex:"pid"},{title:"code",dataIndex:"code"},{title:"user_agent",dataIndex:"user_agent"},{title:"browser",dataIndex:"browser"},{title:"deviceId",dataIndex:"deviceId"},{title:"device",dataIndex:"device"},{title:"ip",dataIndex:"ip"},{title:"platform",dataIndex:"platform"},{title:"geo",dataIndex:"geo"},{title:"lang",dataIndex:"lang"},{title:"countryCode",dataIndex:"countryCode"},{title:"referer",dataIndex:"referer"},{title:"extra",dataIndex:"extra"}],H=function(){var o=k()(h()().mark(function u(){var f;return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,v(!0),t.next=4,B.Z.promotionTrack.getLogListByLimit(100,c,s);case 4:f=t.sent,f&&T(f),v(!1),t.next=14;break;case 9:return t.prev=9,t.t0=t.catch(0),v(!1),console.error(t.t0),t.abrupt("return",!1);case 14:case"end":return t.stop()}},u,null,[[0,9]])}));return function(){return o.apply(this,arguments)}}();return(0,n.useEffect)(function(){H()},[c,s]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Q.Z,{size:"small",scroll:{x:!0},columns:S,dataSource:C,pagination:!1})})},De=Se,q=x.Z.Divider,Ie=function(j){var c=j.type,s=j.value,w=(0,n.useState)(void 0),l=i()(w,2),I=l[0],v=l[1],Z=(0,Y.useIntl)(),F=function(){var C=k()(h()().mark(function T(){var S;return h()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,B.Z.promotionTrack.getAccumulatedData(c,s);case 2:S=o.sent,v(S.data);case 4:case"end":return o.stop()}},T)}));return function(){return C.apply(this,arguments)}}();return(0,n.useEffect)(function(){F()},[]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h1",children:"".concat(Z.formatMessage({id:"pages.promotionTrack.utm_source"}),": ").concat(s)}),(0,e.jsx)("div",{children:(0,e.jsxs)(x.Z.Group,{direction:"row",children:[(0,e.jsx)(x.Z,{children:(0,e.jsx)(R.Z,{title:"\u7D2F\u8BA1\u8BBF\u95EE",value:I?I.view:"-"})}),(0,e.jsx)(q,{type:"vertical"}),(0,e.jsx)(x.Z,{children:(0,e.jsx)(R.Z,{title:"\u7D2F\u8BA1\u4E0B\u8F7D",value:I?I.download:"-"})}),(0,e.jsx)(q,{type:"vertical"}),(0,e.jsx)(x.Z,{children:(0,e.jsx)(R.Z,{title:"\u7D2F\u8BA1\u6CE8\u518C",value:I?I.register:"-"})})]})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h3",children:"30\u5929\u63A8\u5E7F\u66F2\u7EBF"}),(0,e.jsx)(xe,{type:c,value:s})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h3",children:"\u8BBF\u95EE\u7EDF\u8BA1\u6570\u636E \uFF08\u6CE8\u610F\uFF0C\u53D6\u6700\u8FD190\u6761\uFF09"}),(0,e.jsx)(ye,{type:c,value:s})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h3",children:"\u8BBF\u95EE\u65E5\u5FD7 \uFF08\u6CE8\uFF0C\u53D6\u6700\u8FD1100\u6761\uFF09"}),(0,e.jsx)(De,{type:c,value:s})]})]})},Ze=Ie,_=x.Z.Divider,Fe=function(){var j=(0,n.useState)(void 0),c=i()(j,2),s=c[0],w=c[1],l=(0,Y.useIntl)(),I=(0,n.useState)([]),v=i()(I,2),Z=v[0],F=v[1],C=(0,n.useState)(!1),T=i()(C,2),S=T[0],H=T[1],o=(0,n.useState)(!1),u=i()(o,2),f=u[0],g=u[1],t=(0,n.useState)("24H"),b=i()(t,2),M=b[0],N=b[1],ee=(0,n.useState)("utm_source"),p=i()(ee,2),z=p[0],Ce=p[1],Be=(0,n.useState)(""),te=i()(Be,2),ae=te[0],re=te[1],Ee=(0,n.useState)(!1),ne=i()(Ee,2),Le=ne[0],se=ne[1],Pe=(0,n.useState)(void 0),ie=i()(Pe,2),X=ie[0],ue=ie[1],we=[{title:"ID",dataIndex:"value"},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"view",sorter:function(r,d){return r.view-d.view}},{title:"\u4E0B\u8F7D\u6B21\u6570",dataIndex:"download",sorter:function(r,d){return r.download-d.download}},{title:"\u6CE8\u518C\u6B21\u6570",dataIndex:"register",sorter:function(r,d){return r.register-d.register}},{title:"\u72EC\u7ACBIP\u6570",dataIndex:"ip",sorter:function(r,d){return r.ip-d.ip}},{title:"\u72EC\u7ACB\u8BBE\u5907\u6570",dataIndex:"deviceId",sorter:function(r,d){return r.deviceId-d.deviceId}},{title:"\u5907\u6CE8\u4FE1\u606F"},{title:"\u64CD\u4F5C",render:function(r,d){return(0,e.jsx)(A.Z,{size:"middle",children:(0,e.jsx)(E.ZP,{type:"link",onClick:function(){ue({type:z,value:d.value}),se(!0)},children:"\u8BE6\u60C5"})})}}],Me=function(){var m=k()(h()().mark(function r(){var d;return h()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,B.Z.promotionTrack.get24HData();case 2:d=G.sent,w(d.data);case 4:case"end":return G.stop()}},r)}));return function(){return m.apply(this,arguments)}}(),le=function(){var m=k()(h()().mark(function r(d){var O;return h()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return g(!0),V.next=3,B.Z.promotionTrack.getStatisticalList(M,z,d);case 3:O=V.sent,O.data&&F(O.data),g(!1);case 6:case"end":return V.stop()}},r)}));return function(d){return m.apply(this,arguments)}}();return(0,n.useEffect)(function(){Me()},[]),(0,n.useEffect)(function(){re(""),le("")},[z,M]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L.Z,{children:(0,e.jsx)(ve.Z,{onResize:function(r){H(r.width<596)},children:(0,e.jsxs)(x.Z.Group,{direction:S?"column":"row",children:[(0,e.jsx)(x.Z,{children:(0,e.jsx)(R.Z,{title:"24H\u603B\u8BBF\u95EE",value:s?s.view:"-"})}),(0,e.jsx)(_,{type:S?"horizontal":"vertical"}),(0,e.jsx)(x.Z,{children:(0,e.jsx)(R.Z,{title:"24H\u603B\u4E0B\u8F7D",value:s?s.download:"-"})}),(0,e.jsx)(_,{type:S?"horizontal":"vertical"}),(0,e.jsx)(x.Z,{children:(0,e.jsx)(R.Z,{title:"24H\u6CE8\u518C\u6570",value:s?s.register:"-"})})]})},"resize-observer")}),(0,e.jsx)(L.Z,{children:(0,e.jsxs)(oe.Z,{spinning:f,tip:l.formatMessage({id:"loading"}),children:[(0,e.jsxs)("div",{className:"tools",children:[(0,e.jsxs)("div",{className:"search",children:[(0,e.jsx)("div",{className:"item",children:(0,e.jsx)(A.Z,{children:(0,e.jsxs)(P.ZP.Group,{value:z,onChange:function(r){return Ce(r.target.value)},children:[(0,e.jsx)(P.ZP.Button,{value:"utm_source",children:l.formatMessage({id:"pages.promotionTrack.utm_source"})}),(0,e.jsx)(P.ZP.Button,{value:"eid",children:l.formatMessage({id:"pages.promotionTrack.eid"})}),(0,e.jsx)(P.ZP.Button,{value:"pid",children:l.formatMessage({id:"pages.promotionTrack.pid"})}),(0,e.jsx)(P.ZP.Button,{value:"code",children:l.formatMessage({id:"pages.promotionTrack.code"})})]})})}),(0,e.jsx)("div",{className:"item",children:(0,e.jsx)(de.Z,{value:ae,onChange:function(r){return re(r.target.value)}})}),(0,e.jsx)("div",{className:"item",children:(0,e.jsx)(E.ZP,{onClick:function(){return le(ae)},children:"\u641C\u7D22"})})]}),(0,e.jsx)("div",{className:"filter",children:(0,e.jsx)(A.Z,{children:(0,e.jsxs)(P.ZP.Group,{value:M,onChange:function(r){return N(r.target.value)},children:[(0,e.jsx)(P.ZP.Button,{value:"24H",children:"24H"}),(0,e.jsx)(P.ZP.Button,{value:"7D",children:"7D"}),(0,e.jsx)(P.ZP.Button,{value:"1M",children:"1M"})]})})})]}),(0,e.jsx)("div",{children:(0,e.jsx)(Q.Z,{columns:we,dataSource:Z,pagination:!1})}),(0,e.jsx)(ce.Z,{width:600,open:Le,onClose:function(){ue(void 0),se(!1)},closable:!1,children:X&&(0,e.jsx)(Ze,{type:X.type,value:X.value})})]})})]})},Te=Fe},64599:function($,J,a){var K=a(96263);function h(y,k){var D=typeof Symbol!="undefined"&&y[Symbol.iterator]||y["@@iterator"];if(!D){if(Array.isArray(y)||(D=K(y))||k&&y&&typeof y.length=="number"){D&&(y=D);var i=0,B=function(){};return{s:B,n:function(){return i>=y.length?{done:!0}:{done:!1,value:y[i++]}},e:function(L){throw L},f:B}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x=!0,Y=!1,A;return{s:function(){D=D.call(y)},n:function(){var L=D.next();return x=L.done,L},e:function(L){Y=!0,A=L},f:function(){try{!x&&D.return!=null&&D.return()}finally{if(Y)throw A}}}}$.exports=h,$.exports.__esModule=!0,$.exports.default=$.exports}}]);
